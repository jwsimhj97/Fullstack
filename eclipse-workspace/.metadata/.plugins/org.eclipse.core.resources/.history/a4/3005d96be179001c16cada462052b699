package com.hi;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

import oracle.jdbc.driver.OracleDriver;

public class Score {

	public static void main(String[] args) {
		String url="jdbc:oracle:thin:scott/tiger@localhost:1521:xe";
		String sql=null;
		oracle.jdbc.driver.OracleDriver driver;
		
		Connection conn=null;
		java.sql.Statement stmt=null;
		java.sql.ResultSet rs=null;
		
		// 학생성적관리프로그램(ver 0.9.0)
		// 1.보기 2.입력 3.수정 4.삭제 0.종료 >
		Scanner sc=new Scanner(System.in);
		String title="학생성적관리프로그램(ver 0.9.0)";
		String input=null;
		
		System.out.println(title);
		while(true) {
			System.out.print("1.보기 2.입력 3.수정 4.삭제 0.종료 >");
			input=sc.nextLine();
			if(input.equals("0")){
				System.out.println("종료됩니다.");
				break;
			}else if(input.equals("1")){	// 보기
				sql="select * from student order by num asc";	// asc:오름차순 desc:내림차순
				driver=new oracle.jdbc.driver.OracleDriver();
				
				try {
					java.sql.DriverManager.registerDriver(driver);
					conn=DriverManager.getConnection(url);
					stmt=conn.createStatement();
					rs=stmt.executeQuery(sql);
					System.out.println("학번\t이름\t국어\t영어\t수학");
					while(rs.next()) {
						System.out.print(rs.getObject(1)+"\t");
						System.out.print(rs.getObject(2)+"\t");
						System.out.print(rs.getObject(3)+"\t");
						System.out.print(rs.getObject(4)+"\t");
						System.out.println(rs.getObject(5));
					}
					
				} catch (SQLException e) {
					e.printStackTrace();
				}finally {
					try {
						if(rs!=null)rs.close();
						if(stmt!=null)stmt.close();
						if(conn!=null)conn.close();
					} catch (SQLException e) {
						e.printStackTrace();
					}
				}
				
			}else if(input.equals("2")){	// 입력
				sql="insert into student(num,name,subKor,subEng,subMath) values(";
				
				System.out.print("num >");
				input=sc.nextLine();
				sql=sql+input+",'";
				System.out.print("name >");
				input=sc.nextLine();
				sql=sql+input+"','";
				System.out.print("subKor >");
				input=sc.nextLine();
				sql=sql+input+"','";
				System.out.print("subEng >");
				input=sc.nextLine();
				sql=sql+input+"','";
				System.out.print("subMath >");
				input=sc.nextLine();
				sql=sql+input+"')";
				
				driver=new OracleDriver();
				try {
					DriverManager.registerDriver(driver);
					conn=DriverManager.getConnection(url);
					stmt=conn.createStatement();
					stmt.executeUpdate(sql);
				} catch (SQLException e) {
					e.printStackTrace();
				}finally {
					try {
						if(stmt!=null)stmt.close();
						if(conn!=null)conn.close();
					} catch (SQLException e) {
						e.printStackTrace();
					}
				}

				
				
			}else if(input.equals("3")){	// 수정
				System.out.print("수정할 학번 >");
				String num=sc.nextLine();
				System.out.print("수정할 국어 >");
				String subKor=sc.nextLine();
				System.out.print("수정할 영어 >");
				String subEng=sc.nextLine();
				System.out.print("수정할 수학 >");
				String subMath=sc.nextLine();
				sql="update student set "+"subKor="+subKor+","+"subEng="+subEng+","+"subMath="+subMath+" where "+"num="+num+"order by num asc";

				driver=new OracleDriver();
				try {
					stmt=conn.createStatement();
					stmt.executeUpdate(sql);
				} catch (SQLException e) {
					e.printStackTrace();
				}
				System.out.println(sql);
			}else if(input.equals("4")){	// 삭제
				System.out.println("삭제할 학번 >");
				String num=sc.nextLine();
				sql="delete from student where num="+num;
				
				driver=new OracleDriver();
				try {
					stmt=conn.createStatement();
					stmt.executeUpdate(sql);
				} catch (SQLException e) {
					e.printStackTrace();
				}
			} else {
				System.out.println("입력이 잘못되었습니다");
			}
		}
		
		if(stmt!=null)
			try {
				if(stmt!=null) stmt.close();
				if(conn!=null) conn.close();
				if(sc!=null) sc.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
		
	}

}